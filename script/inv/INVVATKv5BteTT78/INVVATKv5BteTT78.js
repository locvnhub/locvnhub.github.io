String.prototype.toFloat=function(){return parseFloat(this.trim())},String.prototype.toInt=function(){return parseInt(this.trim())},String.prototype.dot2Comma=function(){return this.replace(/\./g,",")},String.prototype.comma2dot=function(){return this.replace(/,/g,".")},Number.prototype.ReadNumber=function(t){var e=this.valueOf(),a=t,n=e.toString().split(".")[0],o=e.toString().split(".")[1],r="",i=0,u=0,l=0,s="",c="",m=[];if(0==n&&(e=0),e<0)return"Số tiền \xe2m !";if(0==e&&0==o)return"USD"===t?"Kh\xf4ng đ\xf4 la Mỹ":"EUR"===t?"Kh\xf4ng Euro":"CNY"===t?"Kh\xf4ng CNY":"Kh\xf4ng đồng";if(0==e&&o>0?s=ChuSo[0]:l=e>0?e:-e,e>8999999999999999)return"S\xf4 qu\xe1 lớn!";for(m[5]=Math.floor(l/1e15),isNaN(m[5])&&(m[5]="0"),l-=1e15*parseFloat(m[5].toString()),m[4]=Math.floor(l/1e12),isNaN(m[4])&&(m[4]="0"),l-=1e12*parseFloat(m[4].toString()),m[3]=Math.floor(l/1e9),isNaN(m[3])&&(m[3]="0"),l-=1e9*parseFloat(m[3].toString()),m[2]=parseInt(l/1e6),isNaN(m[2])&&(m[2]="0"),m[1]=parseInt(l%1e6/1e3),isNaN(m[1])&&(m[1]="0"),m[0]=parseInt(l%1e3),isNaN(m[0])&&(m[0]="0"),u=i=m[5]>0?5:m[4]>0?4:m[3]>0?3:m[2]>0?2:m[1]>0?1:0;u>=0;u--){var v=!1;m[u].toString().length<3&&u<i&&(v=!0),c=DocSo3ChuSo(m[u],v),v=!1,s+=c,m[u]>0&&(s+=Tien[u]),u>0&&c.length>0&&(s+=",")}return","==s.substring(s.length-1)&&(s=s.substring(0,s.length-1)),void 0!==o&&0!==parseFloat(o)?(o+="00",r=DocSo3ChuSo(o.substring(0,2),!1),"VND"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" đồng":"USD"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" đ\xf4 la Mỹ v\xe0 "+r+" xu":"EUR"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" euro v\xe0 "+r+" xu":"CNY"==a&&(s=s.substring(1,2).toUpperCase()+s.substring(2)+" tệ v\xe0 "+r+" h\xe0o")):"VND"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" đồng":"USD"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" đ\xf4 la Mỹ":"EUR"==a?s=s.substring(1,2).toUpperCase()+s.substring(2)+" euro":"CNY"==a&&(s=s.substring(1,2).toUpperCase()+s.substring(2)+" tệ"),s.replace(/\s\s+/g," ")},jQuery.fn.ForceNumericOnly=function(){return this.each(function(){$(this).blur(function(){"NaN"==$(this).val()&&$(this).val(0)}),$(this).keypress(function(t){var e=$(this).attr("class"),a=null,n="3"==$("#INV_TYPE").val()||"4"==$("#INV_TYPE").val()||"6"==$("#INV_TYPE").val();if(console.log("ForceNumericOnly- dieuChinh "+$("#INV_TYPE").val()),console.log("keypressed "+window.event.keyCode),window.event){if(a=window.event.keyCode,e.indexOf("number")>-1||e.indexOf("quantity")>-1)return 45==a&&n?checkDotComma(t.target.value,a):(!(a<48)||46==a||44==a)&&(!(a>57)||189==a)&&checkDotComma(t.target.value,a)}else{if(8===(a=t.which))return;if(e.indexOf("number")>-1||e.indexOf("quantity")>-1)return 45==a&&n?checkDotComma(t.target.value,a):!(46!=a&&44!=a&&45!=a&&isDieuChinhGiamTT||a<48&&46!=a&&44!=a&&isDieuChinhGiamTT)&&(!(a>57)||189==a)&&checkDotComma(t.target.value,a)}})})},this.typeCurrency="";var BteGlobal={NEW_ROW_STR:"",ROUND_TOTAL:0,IS_EDIT:0==location.pathname.toLocaleLowerCase().indexOf("/einvoice/edit"),IS_SIGN_REPLACE_TOKEN:"/adjust/createreplaceinvwithtoken"==location.pathname.toLocaleLowerCase(),IS_SIGN_ADJSUT_TOKEN:"/adjust/createadjustinvwithtoken"==location.pathname.toLocaleLowerCase(),PATTERN_TYPE:"1",IS_DIEU_CHINH_AM:!1,IS_DIEU_CHINH_TANG_GIAM:!1};function addExtra10(){if(!document.querySelector("#Extra10")){var t=function(){document.querySelector("#Extra10")||($("#ConvertedAmount").after('<input  class="textr Extra10_ConvertedAmount" title="Đang lưu thẻ Extra10" id="Extra10"  name="Extra10" maxlength="50" type="text" value="0" style="">'),$(".Extra10_ConvertedAmount").on("change.Extra10",function(){$("#ConvertedAmount").val($("#Extra10").val()),$("#ConvertedAmount").attr("value",$("#Extra10").val())})),$("#ConvertedAmount").hide(),""!=$("#ConvertedAmount").val()&&0!=$("#ConvertedAmount").val().FormatNumUK()&&$("#Extra10").val($("#ConvertedAmount").val())};"VND"!=$("#CurrencyUnit").val()&&t(),$("#CurrencyUnit").on("change.Extra10",function(){if("VND"==$(this).val()){$(".Extra10_ConvertedAmount").remove();return}t()}),$("#AmountInWords , #ExchangeRate").on("change.Extra10",function(t){"VND"!=$("#CurrencyUnit").val()?($("#Extra10").val($("#ConvertedAmount").val()),$("#Extra10").attr("value",$("#ConvertedAmount").val()),$(".Extra10_ConvertedAmount").trigger("change.Extra10")):$(".Extra10_ConvertedAmount").remove()}),$('input[type="submit"]').on("mousedown",function(){var t=$(".Extra10_ConvertedAmount").val()||"";$(".Extra10_ConvertedAmount").val(t.FormatNumUK())})}}function cauHinhThueSuatTOKEN(){if(0!=parseInt($("#Amount").val().replace(",","").replace(".",""))){var t="/adjust/createreplaceinvwithtoken"==location.pathname.toLocaleLowerCase();("/adjust/createadjustinvwithtoken"==location.pathname.toLocaleLowerCase()||t)&&($("#VATRateItem").val($("#EX_VATRate").val()).trigger("change"),$("#VATAmount").val($("#VATAmount").attr("value")),$("#Amount").val($("#Amount").attr("value")))}}function SumAmountProduct(){return vTotal=0,vDiscountAmount=0,$("table.products tbody .amount").each(function(t,e){var a=$(e).parents("tr").eq(0).find(".Issum").val(),n=($(e).val()||"0").FormatNumUK();vDiscountAmount+=($(e).parent().parent().find(".discountamount").val()||"0").FormatNumUK(),0==a?vTotal+=($(e).val()||"0").FormatNumUK():2==a&&(vTotal-=($(e).val()||"0").FormatNumUK(),vDiscountAmount+=n)}),{Total:vTotal,DiscountAmount:vDiscountAmount}}function getListProductString(){var t=[],e=0,a=0;return $("table.products tbody tr").each(function(n,o){var r={},i=$(o).find("input[type=text].name");if(0==i.length&&(i=$(o).find("textarea.name")),""!=i.val().trim()){var u=$(o).find("input[type=text].unit"),l=$(o).find("input[type=text].quantity"),s=$(o).find("input[type=text].price"),c=$(o).find("input[type=text].discount"),m=$(o).find("input[type=text].discountamount"),v=$(o).find("input[type=text].amount"),h=$(o).find(":selected:first"),f=$(o).find("input.VATRate:first"),p=$(o).find("input[type=text].code:first");if(v.val()||i.val()){if(r.ProdType=1,r.Name=i.val()||"",r.Unit=u.val()||"",r.Quantity=l.val()||0,r.Price=s.val()||0,r.Discount=c.val()||"0",r.DiscountAmount=m.val()||"0",r.Total=v.val()||"0",r.IsSum=h.val()||0,r.Name=r.Name.replace(/\n/gmi," ").trim(),"-4"==$("#VATRate").val()?r.VATRate=-4:r.VATRate=f.val(),""!=r.Total&&(r.Total=r.Total.replaceAll(".","")),r.Code=(p.val()||"").trim(),a+=(m.val()||"0").FormatNumUK()||0,0>parseFloat(r.VATRate)?r.VATAmount=0:r.VATAmount=(parseFloat(r.VATRate)*parseFloat(r.Total.FormatNumUK())/100).toFixed(BteGlobal.ROUND_TOTAL),r.Amount=(parseFloat(r.VATAmount)+parseFloat(r.Total.FormatNumUK())).toFixed(BteGlobal.ROUND_TOTAL),0>parseFloat(r.Amount)&&"3"!=$("#INV_TYPE").val()&&(r.Amount=-1*r.Amount),""!=r.Amount&&""==r.Name.trim())return e=0,_products.length=0,!1;if(r.Amount.toString().length>18||r.Amount.toString().indexOf("e")>=0||r.Price>0&&(r.Price.toString().length>18||r.Price.toString().indexOf("e")>=0)||r.Quantity>0&&(r.Quantity.toString().length>18||r.Quantity.toString().indexOf("e")>=0))return e=1,_products.length=0,!1;if(r.Discount.FormatNumUK()>100)return e=2,_products.length=0,!1;0!=parseFloat(r.VATAmount)&&(r.VATAmount=r.VATAmount.toString().FormatNumUK2VN()),0!=parseFloat(r.Amount)&&(r.Amount=r.Amount.toString().FormatNumUK2VN());var g=-1==$("table.products th.Extra1TH").attr("class").indexOf("hide"),T=-1==$("table.products th.Extra2TH").attr("class").indexOf("hide"),A=-1==$("table.products th.RemarkTH").attr("class").indexOf("hide");if(g){var C=$(o).find("input.extra1");r.Extra1=C.val(),C.attr("class").indexOf("_number")>-1&&""!=r.Extra1&&(r.Extra1=r.Extra1.FormatNumUK())}if(T){var N=$(o).find("input.extra2");r.Extra2=N.val(),N.attr("class").indexOf("_number")>-1&&""!=r.Extra2&&(r.Extra2=r.Extra2.FormatNumUK())}if(A){var b=$(o).find("input.remark");r.Remark=b.val(),b.attr("class").indexOf("_number")>-1&&""!=r.Remark&&(r.Remark=r.Remark.FormatNumUK())}t.push(r)}}}),{productList:t,check:e,discountAmount:a}}function showExtraProcut(t){$("table.products th."+t+"TH").removeClass("hide"),$("table.products td.col-"+t).removeClass("hide")}function getProductRowStr(){return"<tr>"+$("table.products tbody tr:last").html().trim()+"</tr>"}function apendLastRow(t){var e=$("table.products tbody tr").length-1,a=$("table.products tbody tr").eq(e).find("td").eq(1).text().trim();$("table.products tbody").append(t);var n=$("table.products tbody tr:last");""==a.trim()||isNaN(parseInt(a))?(a=1,n.find("td").eq(1).text("")):(a=parseInt(a)+1,n.find("td").eq(1).text(a.toString())),n.find("#IsSum").val(0),n.find("input").each(function(t,e){!($(e).attr("class")&&$(e).attr("class").indexOf("VATRate")>-1)&&$(e).val("")})}function checkMstCusName(){return""==$("#CusTaxCode").val()||""!=$("#CusName").val().trim()||(alert('Bắt buộc nhập "T\xean đơn vị mua h\xe0ng" nếu c\xf3 nhập M\xe3 số thuế Kh\xe1ch h\xe0ng'),!1)}function checkCusNameBuyer(){return""!=$("#Buyer").val().trim()||""!=$("#CusName").val().trim()||(alert("H\xf3a đơn chưa nhập T\xean đơn vị hoặc Người mua h\xe0ng"),!1)}function submitProducts_ext(t){return t}function submit_over_begin(){}function submit_over(){return!0}function onLastRowFous(){$("table.products tbody input:text").change(function(){var t=$(this),e=t.parents("tbody").children("tr").length;if(t.parents("tr:first").children("td:nth-child(2)").text()==e){var a=!1;t.parents("tr:first").find("input:text").each(function(t,e){$(e).val()&&(a=!0)}),a&&(apendLastRow(BteGlobal.NEW_ROW_STR),bindEvents2Table())}})}function autocompleteProductName(t){var e="name"==(t=t||"name")?"Name":"Code";$("table.products tbody input."+t).data("autocomplete_on",!1).bind("autocompleteopen",function(t,e){$(this).data("autocomplete_on",!0)}).bind("autocompleteclose",function(t,e){$(this).data("autocomplete_on",!1)}).autocomplete({source:function(a,n){console.log("request.term",a),$.ajax({type:"POST",url:"/Product/SeachBy"+e,dataType:"JSON",data:{searchText:a.term},success:function(e){null===e&&("name"==t?$(this).parents("tr:first").find("input.Code").val(""):$(this).parents("tr:first").find("input.Name").val(""));var o=[];o="code"==t?o.concat(e.filter(t=>0==t.Code.indexOf(a.term)).slice(0,5)).concat(e.filter(t=>1==t.Code.indexOf(a.term)).slice(0,3)).concat(e.filter(t=>3==t.Code.indexOf(a.term)).slice(0,3)).concat(e.filter(t=>t.Code.indexOf(a.term)>1).slice(0,5)):o.concat(e.filter(t=>0==t.Name.indexOf(a.term)).slice(0,5)).concat(e.filter(t=>1==t.Name.indexOf(a.term)).slice(0,3)).concat(e.filter(t=>3==t.Name.indexOf(a.term)).slice(0,3)).concat(e.filter(t=>t.Name.indexOf(a.term)>0).slice(0,5)),n($.map(o,function(t){return{label:t.Code+" | "+t.Name,Name:t.Name,Unit:t.Unit,Price:t.Price,Code:t.Code}}))}})},minLength:1,select:function(a,n){return $(this).parents("tr:first").find("input.unit").val(n.item.Unit),"name"==t?$(this).parents("tr:first").find("input.code").val(n.item.Code):$(this).parents("tr:first").find("input.name").val(n.item.Name),$(this).parents("tr:first").find("input.price").val(n.item.Price.toString().replace(".",",")).trigger("focusout"),9!=a.which||9!=a.keyCode?$(this).parents("tr:first").find("input.quantity").focus():$(this).parents("tr:first").find("input.unit").focus(),$(this).val(n.item[e]).trigger("change"),!1},appendTo:"#searchAutocomplete",open:function(){var t=$(this).position(),e=t.left,a=t.top+20;$("#searchAutocomplete > ul").css({left:e+"px",top:a+"px"})}})}function onSumAmountProduct(){$(`table.products tbody .quantity 
          , table.products tbody .price
          , table.products tbody .discountamount
          ,table.products tbody .Issum`).change(function(t){var e=$("#TotalFomular").val()||1;if(2==e&&$(t.target).attr("class").indexOf("price")>-1||3==e&&$(t.target).attr("class").indexOf("quantity")>-1)return;let a=$(this).parents("tr:first");var n=(a.find("input.price").val()||"0").FormatNumUK();BteGlobal.IS_DIEU_CHINH_AM||BteGlobal.IS_DIEU_CHINH_TANG_GIAM||(n=Math.abs(n));var o=(a.find("input.quantity").val()||"0").FormatNumUK(),r=$("#totalRound").val(),i=(a.find("input.discountamount").val()||"0").FormatNumUK();if(3==e){var u=a.find("input.amount").val().FormatNumUK()||0;0!=n&&(o=BteGlobal.IS_DIEU_CHINH_TANG_GIAM?u/n:Math.abs(u/n),a.find("input.quantity").attr("value",o.toFixed(r)),a.find("input.quantity").val(o.toFixed(r).toFloat().format(0,3,typeCurrency)))}else if(2==e){var u=a.find("input.amount").val().FormatNumUK()||0;0!=o&&(n=BteGlobal.IS_DIEU_CHINH_TANG_GIAM?u/o:Math.abs(u/o),a.find("input.price").attr("value",n.toFixed(r)),a.find("input.price").val(n.toFixed(r).toFloat().format(0,3,typeCurrency)))}else{var u=o*n-i;if(a.find("input.amount").attr("title",u.toString()),0!=n||0!=o){"3"==$("#INV_TYPE").val()&&(u*=-1);var l=u.toFixed(r).toFloat().format(0,3,typeCurrency);a.find("input.amount").val(l).trigger("change")}else a.find("input.amount").val(0).trigger("change")}onSumAmountProduct_ext()}),onSumAmountProduct_over()}function onSumAmountProduct_ext(){}function onSumAmountProduct_over(){}function onDiscountProductChange(){$("table.products tbody .discount").change(function(){let t=$(this).parents("tr:first");var e,a=t.find("input.name").val(),n=t.find("input.price").val().FormatNumUK()||0,o=n*(t.find("input.quantity").val().FormatNumUK()||0)*(t.find("input.discount").val().FormatNumUK()||0)/100;o>0?t.find("input.discountamount").val(o.toFixed($("#totalRound").val()).toString().FormatNumUK2VN()).trigger("change"):""!=a?t.find("input.discountamount").val(0).trigger("change"):t.find("input.discountamount").val("").trigger("change")}),onDiscountProductChange_over()}function onDiscountProductChange_over(){}function onIssumProductChange(){$("table.products tbody .Issum").change(function(t){var e=$(this).parents("tr");"2"==$(this).val()?(e.find(".discount").val(""),e.find(".discountamount").val(""),e.find(".discount").attr("disabled","disabled"),e.find(".discountamount").attr("disabled","disabled")):(e.find(".discount").attr("disabled",!1),e.find(".discountamount").attr("disabled",!1))})}function onSumTotal(){$(`table.products tbody .amount,
        table.products tbody .Issum`).change(function(t){var e=0,a=0,n=$("#INV_TYPE").val()||"0",o=($(t.target).parents("tr").find(".amount").val()||"0").FormatNumUK();if("3"==n&&-1==o.toString().indexOf("-")&&o>0&&$(t.target).parents("tr").find(".amount").val("-"+o.format(0,3,typeCurrency)),e=(d=SumAmountProduct()).Total,a=d.DiscountAmount,2==$("#TotalFomular").val()){var r=$(t.target).closest("tr");r.find(".quantity").trigger("change")}else if(3==$("#TotalFomular").val()){var r=$(t.target).parents("tr").eq(0);r.find(".price").trigger("change")}$("#Total").val(e.toFixed(BteGlobal.ROUND_TOTAL).toFloat().format(0,3,typeCurrency)).trigger("change"),$("#DiscountAmount").val(a.toFixed().toFloat().format(0,3,typeCurrency)).trigger("change"),onSumTotal_ext()}),onSumTotal_over()}function onSumTotal_ext(){}function onSumTotal_over(){}function ChangeVATRateF(){$("#VATRateItem").trigger("change")}function changePosExtraInput(){}function nhapSTT(){$("table.products tr td.delr").each(function(t,e){var a=$(this).parents("tr"),n=a.find("td").eq(1),o=a.find("td.col-Remark");o.removeClass("hide"),o.addClass("text-center"),o.find("input").addClass("text-center"),o.find("input").removeClass("textr"),n.after(o),a.find("td.col-Remark").eq(1).remove()}),$("table.products tr td.delr").each(function(t,e){var a=$(this).parents("tr");a.find("td").eq(1).hide(),a.find("td.col-Remark"),a.find("td.col-Remark").eq(1).remove()}),$("table.products tr th").eq(1).hide();var t=$("table.products tr th.RemarkTH");t.removeClass("hide"),t.text("STT"),t.css({width:"30px"}),t.addClass("text-center"),$("table.products tr th").eq(1).after(t),BteGlobal.NEW_ROW_STR=getProductRowStr()}function configTableProduct(t){if(t&&0!=t.length&&t[0].tag){for(var e=0;e<t.length;e++){var a=t[e],n=parseInt(a.pos),o="."+a.tag,r=$("table.products th."+a.tag+"TH");0==$("table.products "+o.toLowerCase()).length&&console.log(" Tag: "+o+" not found"),r.removeClass("hide"),a.header&&r.html(a.header),a.width&&""!=a.width&&r.css("width",a.width),!isNaN(n)&&n>0&&($("table.products th").eq(n).before($("table.products th."+a.tag+"TH")),$("table.products tr").each(function(){var t=$(this).find(o.toLowerCase()).parents("td");t.removeClass("hide"),$(this).find("td").eq(n).before(t.eq(0))})),a.classInput&&$("table.products tr").each(function(){var t=$(this).find(o.toLowerCase());t.attr("class",a.tag.toLowerCase()),t.addClass(a.classInput)}),"1"==a.hide&&($("table.products th."+a.tag+"TH").addClass("hide"),$("table.products tr").each(function(){var t=$(this).find(o.toLowerCase());t.parents("td").eq(0).addClass("hide"),t.addClass("hide")}))}BteGlobal.NEW_ROW_STR=getProductRowStr()}}function resetValNumProduct(){$("#bodyTblProduct input._number[value]").each(function(t,e){var a=$(e).attr("value"),n=$(e).attr("class");a&&-1==n.indexOf("amount")&&$(e).val(a.trim().replace(".",","))})}function setAmDonGia(){"3"==$("#INV_TYPE").val()&&$("table.products tbody input.price._number").each(function(){var t=$(this).val()||"0";t.FormatNumUK()>0&&""!=t&&"0"!=t&&$(this).val(parseFloat("-"+Math.abs(t.FormatNumUK())).format(2,3,typeCurrency,!0))})}function CheckDiscountEmpty(){var t=($("#DiscountNonTax").val()||"0").FormatNumUK(),e=($("#DiscountOther").val()||"0").FormatNumUK();return 0==t&&0==e||($("#DiscountNonTax").parents(".line").eq(0).show().removeClass("hidden"),$("#DiscountOther").parents(".line").eq(0).show().removeClass("hidden"),!1)}function ViewDetailInv(){if(!$("form:first").valid())return!1;submit(),$.ajax({type:"POST",url:"/Share/ajxPreviewCreateInv",data:$("form:first").serialize(),success:function(t){$("#container").html(t+"<div class='pagination'><span id='prev' class='prevnext'><</span><span id='next' class='prevnext'></span></div>"),$(function(){$("#4plugin").remove(),$("#plugin0").remove(),$("#ViewInvoice").bPopup({easing:"easeOutBack",speed:450,transition:"slideDown"}),2==$(".pagination span").length&&$("#quantitypages").ProductNumberPagination({number:1})}),$("#ArisingDate").attr("name","ArisingDate"),$("#defaultArisingDate").attr("name","defaultArisingDate")}})}$(document).ready(function(){$("#Name").attr("readonly",!0),BteGlobal.IS_DIEU_CHINH_AM="3"==$("#INV_TYPE").val(),BteGlobal.IS_DIEU_CHINH_TANG_GIAM="6"==$("#INV_TYPE").val(),cauHinhSoLe(),typeCurrency=$("#CurrencyUnit").val(),searchCusName(),searchCodeCus(),bindEvents2Table(),changeVAT(),$("#CusAddress").keyup(function(){checkTextMaxLength(this)}),$("input[type=text]:first").focus(),checkTaxCode(),$(".formatTaxCode").formatTaxCode(),loadCurrencyUnit(),changeCurrencyUnit(),changeExchangeRate(),$("#moneySymbol")[0].innerHTML=typeCurrency,$("#ArisingDate").change(function(){var t=$("#ArisingDate").val();if(null==Date.parseExact(t,"d/M/yyyy")&&null!=t){var e=localStorage.getItem("VNPT_localization"),a="Ng\xe0y kh\xf4ng đ\xfang định dạng";"en"===e&&(a="The date is not in the correct format"),alert(a),$("#ArisingDate").val($("#defaultArisingDate").val())}}),BteGlobal.NEW_ROW_STR=getProductRowStr(),BteGlobal.ROUND_TOTAL="VND"==$("#CurrencyUnit").val()?0:2,BteGlobal.PATTERN_TYPE=$("#patternTypeNum").val(),BteGlobal.IS_INV_NO_VAT="2"==$("#patternTypeNum").val(),BteGlobal.PATTERN_NUM=$("#Pattern").val().replace("/",""),BteGlobal.IS_INV_NO_VAT&&($("#VATRateItem").val("-4"),$("#VATRate").val("-4"));var t=$("#EX_CurrencyUnit").val();""!=t&&"VND"!=t&&t!=$("#urrencyUnit").val()&&$("#CurrencyUnit").val($("#EX_CurrencyUnit").val()),addExtra10(),cauHinhThueSuatTOKEN(),"true"==localStorage.getItem(BteGlobal.PATTERN_NUM+"hideDiscountOpt")&&!0==CheckDiscountEmpty()&&$("#hideDiscountOpt").prop("checked",!0).trigger("change")}),$("#btnAddRow").on("click",function(){apendLastRow(BteGlobal.NEW_ROW_STR),bindEvents2Table()}),this.dieuHuong=function(){$("table.products tbody input").bind("keydown.nav",function(t){var e=0;$(this).is(":checkbox")||(e=this.selectionStart);var a=$(this).val().length,n=$(this).parents("td:first").index(),o=$(this).parents("tr:first").index();if(13==t.which||13==t.keyCode)return!1;if(!$(this).data("autocomplete_on"))switch(t.which||t.keyCode){case 37:if($(this).is(":checkbox")||!$(this).val()||!$(this).is(":checkbox")&&e<=0){var r=$("table.products tbody").children("tr:nth-child("+(o+1)+")"),i=$(r).children("td:nth-child("+n+")").children("input:first").focus();return i.length>0&&$(this).trigger("change").trigger("blur"),!1}break;case 38:var u=$("table.products tbody").children("tr:nth-child("+o+")"),i=$(u).children("td:nth-child("+(n+1)+")").children("input:first").focus();return i.length>0&&$(this).trigger("change").trigger("blur"),!1;case 39:if($(this).is(":checkbox")||!$(this).val()||!$(this).is(":checkbox")&&e>=a){var l=$("table.products tbody").children("tr:nth-child("+(o+1)+")"),i=$(l).children("td:nth-child("+(n+2)+")").children("input:first").focus();return i.length>0&&$(this).trigger("change").trigger("blur"),!1}break;case 40:var s=$("table.products tbody").children("tr:nth-child("+(o+2)+")"),i=$(s).children("td:nth-child("+(n+1)+")").children("input:first").focus();return i.length>0&&$(this).trigger("change").trigger("blur"),!1}})},this.checkTaxCode=function(){$("#CusTaxCode").blur(function(){var t=$(this);$("#errorTaxCode").remove(),t.val()?$.ajax({type:"POST",url:"/Company/checkMST/",data:{mst:$(this).val()},success:function(e){e?(t.removeClass("error"),$("#CusAddress").addClass("required"),$("#lbCusAddress").addClass("imp")):t.addClass("error").parent(".control").append('<label id="errorTaxCode" for="CusTaxCode" generated="true" class="error">M\xe3 số thuế kh\xf4ng hợp lệ</label>')}}):(t.removeClass("error"),$("#CusAddress").removeClass("required"),$("#lbCusAddress").removeClass("imp"))})},this.submit=function(){if(!checkMstCusName())return!1;var t=localStorage.getItem("VNPT_localization");submit_over_begin();var e=0;$("#VatAmount0").val("0"),$("#VatAmount5").val("0"),$("#VatAmount10").val("0"),$("#GrossValue").val("0"),$("#GrossValue0").val("0"),$("#GrossValue5").val("0"),$("#GrossValue10").val("0"),$("#GrossValueNonTax").val("0"),$("#VATAMOUNTOTHER").val("0"),$("#GROSSVALUEOTHER").val("0"),$("#VatAmount8").val("0"),$("#GrossValue8").val("0");var a=$("#Total").val().FormatNumUK(),n=$("#VATAmount").val().FormatNumUK(),o=$("#VATRateItem").val().toFloat(),r=$("#VATRateF").val();if(-99==o&&""!=r&&[0,5,8,10,-1,-2].indexOf(r=r.FormatNumUK())>-1&&($("#VATRateItem").val(r),$("#VATRateF").val(""),o=r),BteGlobal.IS_INV_NO_VAT&&(o=-4),o>0)10==o?($("#VatAmount10").val(n.toString().replaceAll(".",",")),$("#GrossValue10").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o)):5==o?($("#VatAmount5").val(n.toString().replaceAll(".",",")),$("#GrossValue5").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o)):8==o&&($("#VatAmount8").val(n.toString().replaceAll(".",",")),$("#GrossValue8").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o));else if(-99==o){var i=$("#VATRateF").val();(""==$("#VATRateF").val()||null==$("#VATRateF").val())&&(i=-3,$("#VATRateF").val(i),$("table.products .VATRate").val(i)),o=parseFloat(i||"0"),$("#VATAMOUNTOTHER").val(n.toString().replaceAll(".",",")),$("#GROSSVALUEOTHER").val(a.toString().replaceAll(".",",")),$("#VATRate").val($("#VATRateF").val())}else -1==o?($("#GrossValue").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o)):0==o?($("#VatAmount0").val("0"),$("#GrossValue0").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o)):-2==o&&($("#GrossValueNonTax").val(a.toString().replaceAll(".",",")),$("#VATRate").val(o));if($("#errorTaxCode").length>0){$("#errorTaxCode").show(),$("#CusTaxCode").addClass("error");var u="Xin lỗi, m\xe3 số thuế của kh\xe1ch h\xe0ng kh\xf4ng chuẩn.\n- Bạn c\xf3 muốn tiếp tục lưu h\xf3a đơn kh\xf4ng?";if("en"===t&&(u="Sorry, The Customer's Tax Code Is Not Correct. \n- Do You Want To Continue To Save The Invoice?"),!confirm(u))return!1}if($("#Total").val().indexOf("-")>=0&&"3"!=$("#INV_TYPE").val()&&!1==BteGlobal.IS_DIEU_CHINH_TANG_GIAM){var l="Xin lỗi, h\xf3a đơn c\xf3 gi\xe1 trị \xe2m [Tổng tiền h\xf3a đơn], chưa thể ph\xe1t sinh giao dịch.";return"en"===t&&(l="Sorry, The Invoice Has A Negative Value [amount Invoice], No Transactions Yet."),alert(l),!1}if($("#Total").val().FormatNumUK()>=2e7&&"CK"!=$("#PaymentMethod").val()){var s="Số tiền qu\xe1 lớn, bạn n\xean thanh to\xe1n chuyển khoản.\n- Bạn c\xf3 muốn tiếp tục lưu h\xf3a đơn kh\xf4ng?";if("en"===t&&(s="The Amount Is Too Large, You Should Pay For The Transfer. \n- Do You Want To Continue To Save The Invoice?"),!confirm(s))return!1}var c=$("#INV_TYPE").val(),m=$("#Amount").val().FormatNumUK(),v=$("#OldAmount").val();if("3"==c&&v>0&&m>=(v=v.FormatNumUK())){var s="Bạn đang lập h\xf3a đơn điều chỉnh giảm qu\xe1 100% chi tiết h\xe0ng h\xf3a trong h\xf3a đơn gốc.\n- Bạn c\xf3 muốn tiếp tục lưu h\xf3a đơn kh\xf4ng?";if(!confirm(s))return!1}"3"==$("#INV_TYPE").val()&&["VatAmount0","VatAmount5","VatAmount10","GrossValue","GrossValue0","GrossValue5","GrossValue10","GrossValueNonTax","VATAMOUNTOTHER","GROSSVALUEOTHER","VatAmount8","GrossValue8"].forEach(function(t){var e=$("#"+t).val();e&&e.FormatNumUK()>0&&$("#"+t).val("-"+e)});var h=0,f=[],p=getListProductString();if(f=p.productList,e=p.check,h=($("#DiscountAmount").val()||"0").FormatNumUK(),0==f.length){if(0==e){var g="Xin lỗi, danh s\xe1ch sản phẩm chưa c\xf3 hoặc th\xf4ng tin sản phẩm bị thiếu!";"en"===t&&(g="Sorry, Product Listings Are Unavailable, Or Product Information Is Missing!"),alert(g)}else if(1==e){var T="Xin lỗi, danh s\xe1ch sản phẩm c\xf3 chứa sản phẩm vượt qu\xe1 gi\xe1 trị cho ph\xe9p của h\xf3a đơn!";"en"===t&&(T="Sorry, The Product List Contains Products That Exceed The Allowed Value Of The Invoice"),alert(T)}else{var A="Xin lỗi, danh s\xe1ch sản phẩm c\xf3 chứa sản phẩm vượt qu\xe1 gi\xe1 trị chiết khấu cho ph\xe9p!";"en"===t&&(A="Sorry, The product list contains products that exceed the allowed discount value"),alert(A)}return!1}f=submitProducts_ext(f),$("#PubDatasource").val(JSON.stringify(f)),$("#DiscountAmount").val(Math.round(h).format(0,3,typeCurrency).replaceAll(".",""));var C,N=new Date,b=String(N.getDate()).padStart(2,"0"),y=b+"/"+String(N.getMonth()+1).padStart(2,"0")+"/"+N.getFullYear();void 0!=$("#dateTimeClient").val()&&$("#dateTimeClient").val(y);var x=parseInt($("#isArisingDate").val()||"0");return""==$("#ArisingDate").val()&&1==x?($("#ArisingDate").val(y),$("#defaultArisingDate").val(y)):""==$("#ArisingDate").val()&&0==x&&($("#ArisingDate").attr("name","ArisingDate_remove"),$("#defaultArisingDate").attr("name","defaultArisingDate_remove")),""!=$("#ArisingDate").val()&&0==x&&$("#isArisingDate").val(1),$("input[type=text]._number").each(function(t,e){var a=$(this).val();$(this).val(a.replaceAll(".",""))}),!1!=submit_over()},this.searchCusName=function(){$("#CusName").autocomplete({focus:function(t,e){},minLength:1,select:function(t,e){$("#CusTaxCode").val(e.item.TaxCode),$("#CusAddress").val(e.item.Address),$("#CusPhone").val(e.item.Phone),$("#CusCode").val(e.item.Code),$("#EmailDeliver").val(e.item.EmailDeliver),$("#CusBankName").val(e.item.CusBankName),$("#CusBankNo").val(e.item.CusBankNo),$("#Buyer").val(e.item.Buyer)},source:function(t,e){$.ajax({data:{searchText:t.term},dataType:"JSON",success:function(t){e($.map(t,function(t){if(null!=t.cusname&&""!=t.cusname)return{id:t.cusid,value:t.cusname,TaxCode:t.TaxCode,Address:t.Address,Phone:t.Phone,Code:t.Code,EmailDeliver:t.EmailDeliver,Buyer:t.Buyer,CusBankName:t.CusBankName,CusBankNo:t.CusBankNo}}))},type:"POST",url:"/Customer/SeachByName"})},appendTo:"#searchAutocomplete",open:function(){var t=$(this).position(),e=t.left,a=t.top+20;$("#searchAutocomplete > ul").css({left:e+"px",top:a+"px"})}}).change(function(){$(this).val()||($("#CusTaxCode").val(""),$("#CusAddress").val(""),$("#CusPhone").val(""),$("#CusCode").val(""),$("#EmailDeliver").val(""),$("#Buyer").val()||$("#Buyer").val(""),$("#CusBankName").val(""),$("#CusBankNo").val(""))}),$("#Buyer").autocomplete({focus:function(t,e){},minLength:1,select:function(t,e){$("#CusTaxCode").val(e.item.TaxCode),$("#CusAddress").val(e.item.Address),$("#CusPhone").val(e.item.Phone),$("#CusCode").val(e.item.Code),$("#EmailDeliver").val(e.item.EmailDeliver),$("#CusBankName").val(e.item.CusBankName),$("#CusBankNo").val(e.item.CusBankNo),$("#CusName").val(e.item.cusname)},source:function(t,e){$.ajax({data:{searchText:t.term},dataType:"JSON",success:function(t){e($.map(t,function(t){if(null!=t.Buyer&&""!=t.Buyer)return{id:t.cusid,cusname:t.cusname,TaxCode:t.TaxCode,Address:t.Address,Phone:t.Phone,Code:t.Code,EmailDeliver:t.EmailDeliver,value:t.Buyer,CusBankName:t.CusBankName,CusBankNo:t.CusBankNo}}))},type:"POST",url:"/Customer/SeachByName"})},appendTo:"#searchAutocomplete",open:function(){var t=$(this).position(),e=t.left,a=t.top+20;$("#searchAutocomplete > ul").css({left:e+"px",top:a+"px"})}}).change(function(){$(this).val()||($("#CusTaxCode").val(""),$("#CusAddress").val(""),$("#CusPhone").val(""),$("#CusCode").val(""),$("#EmailDeliver").val(""),$("#CusName").val()||$("#CusName").val(""),$("#CusBankName").val(""),$("#CusBankNo").val(""))})},this.searchCodeCus=function(){$("#CusCode").autocomplete({focus:function(t,e){},minLength:1,select:function(t,e){$("#CusTaxCode").val(e.item.TaxCode),$("#CusAddress").val(e.item.Address),$("#CusPhone").val(e.item.Phone),$("#CusName").val(e.item.cusname),$("#EmailDeliver").val(e.item.EmailDeliver),$("#CusBankName").val(e.item.CusBankName),$("#CusBankNo").val(e.item.CusBankNo),$("#Buyer").val(e.item.Buyer)},source:function(t,e){$.ajax({data:{searchText:t.term},dataType:"JSON",success:function(t){e($.map(t,function(t){return{id:t.cusid,value:t.Code,TaxCode:t.TaxCode,Address:t.Address,Phone:t.Phone,cusname:t.cusname,EmailDeliver:t.EmailDeliver,Buyer:t.Buyer,CusBankName:t.CusBankName,CusBankNo:t.CusBankNo}}))},type:"POST",url:"/Customer/SeachByCusCode"})},appendTo:"#searchAutocomplete",open:function(){var t=$(this).position(),e=t.left,a=t.top+20;$("#searchAutocomplete > ul").css({left:e+"px",top:a+"px"})}}).change(function(){$(this).val()||($("#CusTaxCode").val(""),$("#CusAddress").val(""),$("#CusPhone").val(""),$("#CusName").val(""),$("#EmailDeliver").val(""),$("#Buyer").val(""),$("#CusBankName").val(""),$("#CusBankNo").val(""))})},$("#DiscountNonTax").change(function(){$("input.amount").eq(0).trigger("change")}),$("#DiscountOther").change(function(){$("input.amount").eq(0).trigger("change")}),$("#Total").change(function(){$("#VATRateItem").trigger("change"),$("#VATRate").trigger("change"),readAfterAmountChanged()}),$("#DiscountAmount").change(function(t){0!=($(this).val()||"0").FormatNumUK()?$(this).parents(".line").eq(0).show().removeClass("hidden"):$(this).parents(".line").eq(0).hide()}),$("#VATAmount").change(function(){readAfterAmountChanged()}),$("#Amount").change(function(){var t=($(this).val()||"0").FormatNumUK(),e=$("#CurrencyUnit option:selected").val().trim()||"VND";if("6"==$("#INV_TYPE").val())t<0?$("#AmountInWords").val("Giảm "+Math.abs(t).ReadNumber(e).toLowerCase()):$("#AmountInWords").val("Tăng "+Math.abs(t).ReadNumber(e).toLowerCase());else if("3"==$("#INV_TYPE").val())t>0&&$(this).val("-"+$(this).val()),$("#AmountInWords").val("Giảm "+Math.abs(t).ReadNumber(e).toLowerCase());else{var a=t.ReadNumber($("#CurrencyUnit option:selected").val()).trim();a[0]&&(a=a[0].toUpperCase()+a.slice(1)),$("#AmountInWords").val(a)}$("#AmountInWords").trigger("change")}),$("#AmountInWords").change(function(t){$(t.target).val($(t.target).val().replace("  "," ")),$(t.target).trigger("change.Extra10")}),this.bindEvents2Table=function(){$("table.products tbody input").unbind().removeData(),$("table.products tbody").find("input").autocomplete(),$("table.products tbody").find("input").autocomplete("destroy"),formatTagInputNumber(typeCurrency),$("table.products tbody tr").each(function(t,e){var a=$(e).children("td:first");$(a).unbind().click(function(){$("table.products tbody tr").length>2&&confirm("Bạn c\xf3 chắc chắn muốn x\xf3a d\xf2ng sản phẩm n\xe0y?")&&($(e).remove(),$("table.products tbody tr").each(function(t,e){$(e).children("td:nth-child(2)").text(t+1)}),$("table.products tbody input.amount:first").trigger("change"))})}),onDiscountProductChange(),onSumAmountProduct(),$("table.products input").on("change",function(){$(this).attr("title",$(this).val())}),onSumTotal(),$("table.products tbody .discount").unbind("focusout"),$("table.products tbody .discount").focusout(function(t){var e=$(this).val();""!=e&&$(this).val(e.toFloat().toFixed(2).FormatNumUK2VN())}),onIssumProductChange(),autocompleteProductName("name"),autocompleteProductName("code"),dieuHuong(),onLastRowFous(),bindEvents2Table_over()},this.bindEvents2Table_over=function(){},this.changeVAT=function(){$("#VATRateItem").change(function(){console.log("VATRateItem change");var t=parseInt($(this).val());if(console.log(`VATRateItem ${t}`),-4==t){console.log("_vatrate -4 return ");return}if(-99===t&&0!=t&&5!=t&&10!=t&&-1!=t&&-2!=t&&8!=t){$("#thueKhacId").show();var e=($("#VATRateF").val()||"-3").FormatNumUK(),a=parseFloat(e);setAmountInWords(a);for(var n=0;n<$(".VATRate").length;n++)$(".VATRate")[n].value=$("#VATRateF").val()}else{$("#thueKhacId").hide(),setAmountInWords(t);for(var o=$("#VATRateItem option:selected").val(),n=0;n<$(".VATRate").length;n++)$(".VATRate")[n].value=o}convertAmount()})},this.setAmountInWords=function(t){var e=$("#Total").val()||"0",a=($("#DiscountNonTax").val()||"0").FormatNumUK(),n=$("#VATRateF").val()||"-3";if(n=n.FormatNumUK(),totalNumABS=Math.abs(e=e.FormatNumUK()),0==e)return $("#Amount").val(0).attr("value",0),$("#VATAmount").val("0"),$("#AmountInWords").val("Kh\xf4ng đồng"),e;var o=0,r=0;-99==(t=parseFloat(t))||-3==t?(o=-3==n?($("#VATAmount").val()||"0").FormatNumUK():parseFloat(((e-a)*n/100).toFixed(BteGlobal.ROUND_TOTAL)),r=e+o):t>0?(o=parseFloat(((e-a)*t/100).toFixed(BteGlobal.ROUND_TOTAL)),r=e+o,$("#VATAmount").val(o.format(0,3,typeCurrency))):($("#VATAmount").val("0"),r=e);var i=parseFloat(r.toFixed(BteGlobal.ROUND_TOTAL));"6"==$("#INV_TYPE").val()?i<0?$("#AmountInWords").val("Giảm "+Math.abs(i).ReadNumber(typeCurrency).replace(/\s\s+/g," ").toLowerCase()):$("#AmountInWords").val("Tăng "+Math.abs(i).ReadNumber(typeCurrency).replace(/\s\s+/g," ").toLowerCase()):"3"==$("#INV_TYPE").val()||i<0&&"/adjust/createadjustinvwithtoken"==location.pathname.toLowerCase()?$("#AmountInWords").val("Giảm "+Math.abs(i).ReadNumber(typeCurrency).replace(/\s\s+/g," ").toLowerCase()):$("#AmountInWords").val(parseFloat(i).ReadNumber(typeCurrency).replace(/\s\s+/g," ")),-3!=n&&$("#VATAmount").val(o.format(0,3,typeCurrency)),$("#Amount").val(i.format(0,3,typeCurrency)).attr("value",i.format(0,3,typeCurrency)),setAmountInWords_over(t)},this.setAmountInWords_over=function(t){},this.loadCurrencyUnit=function(){var t=$("#CurrencyUnit").val();"VND"==t?(document.getElementById("divTyGia").style.display="none",document.getElementById("divTongTien").style.display="none"):""!=t&&(document.getElementById("divTyGia").style.display="block",document.getElementById("divTongTien").style.display="block")},this.changeCurrencyUnit=function(){$("#CurrencyUnit").change(function(){"VND"==$(this).val()?($("#ExchangeRate").val(""),$("#ConvertedAmount").val(""),document.getElementById("divTyGia").style.display="none",document.getElementById("divTongTien").style.display="none",BteGlobal.ROUND_TOTAL=0):""!=$(this).val()&&(BteGlobal.ROUND_TOTAL=2,document.getElementById("divTyGia").style.display="block",document.getElementById("divTongTien").style.display="block"),typeCurrency=$(this).val(),formatTagInputNumber($(this).val()),$("#VATRateItem").trigger("change"),$("#moneySymbol")[0].innerHTML=$(this).val()})},this.changeExchangeRate=function(){$("#ExchangeRate").focusout(function(){convertAmount()})},this.convertAmount=function(){var t,e=$("#ExchangeRate").val().FormatNumUK();if(e?t=parseFloat(e):(t=0,$("#ExchangeRate").val(0)),null!==$("#Amount").val()&&t>=0&&"VND"!=$("#CurrencyUnit").val()){var a=parseFloat($("#Amount").val().FormatNumUK()),n=parseFloat((a*t).toFixed());"3"==$("#INV_TYPE").val()&&n>0?$("#ConvertedAmount").val("-"+n.format(0,3,"USD")):$("#ConvertedAmount").val(n.format(0,3,"USD"))}},this.formatTagInputNumber=function(t){$("#ConvertedAmount").InitialMoneyUSD(),$("table.products tbody input._number").unbind("focusout"),$("#ExchangeRate").formatOnlyNumber(),$("table.products tbody input._number").each(function(t,e){fnInitialFormatNumber(this),BteGlobal.IS_EDIT||BteGlobal.IS_SIGN_REPLACE_TOKEN||BteGlobal.IS_SIGN_ADJSUT_TOKEN||$(this).parents("tr:first").find("input.amount").trigger("change")}).ForceNumericOnly().focus(function(){var t=$(this).val();$(this).val(t.replaceAll(".",""))}).focusout(function(){fnFocusOut(this),BteGlobal.IS_EDIT||BteGlobal.IS_SIGN_REPLACE_TOKEN||BteGlobal.IS_SIGN_ADJSUT_TOKEN||$(this).parents("tr:first").find("input.amount").trigger("change")}),$("table.list-bin-bottom tbody input._number").unbind("focusout"),$(".groupTotal").each(function(t,e){fnInitialFormatNumber(this)}).ForceNumericOnly().focus(function(){var t=$(this).val();$(this).val(t.replaceAll(".",""))}).focusout(function(){fnFocusOut(this)}),formatTagInputNumber_over(t)},this.formatTagInputNumber_over=function(t){},this.fnInitialFormatNumber=function(t){var e=$(t).val();e&&(e=e.replaceAll(".","").replaceAll(",","."),$(t)[0].className.indexOf("quantity")>-1?e.indexOf(".")>-1?$(t).val(parseFloat(e).format(2,3,typeCurrency,!0)):$(t).val(parseFloat(e).format(0,3)):"VND"==typeCurrency?$(t).val(parseFloat(e).format(0,3)):"USD"==typeCurrency&&$(t).val(parseFloat(e).format(2,3,typeCurrency)))},jQuery.event.copy=function(t,e){t=t.jquery?t:jQuery(t),e=e.jquery?e:jQuery(e);var a=t[0].events||jQuery.data(t[0],"events")||jQuery._data(t[0],"events");if(t.length&&e.length&&a)return e.each(function(){for(var t in a)for(var e in a[t])jQuery.event.add(this,t,a[t][e],a[t][e].data)})},this.readAfterAmountChanged=function(){var t=parseFloat($("#Total").val().FormatNumUK()),e=parseFloat(($("#DiscountOther").val()||"0").FormatNumUK()),a=0,n=0;$("#VATAmount").val()&&(a=parseFloat($("#VATAmount").val().FormatNumUK())),n=BteGlobal.IS_DIEU_CHINH_TANG_GIAM?t-e+a:Math.abs(t)-Math.abs(e)+Math.abs(a);var o=Math.abs(parseFloat(n)).ReadNumber(typeCurrency).replace(/\s\s+/g," ").toLowerCase();0==n&&(o="Kh\xf4ng"+1..ReadNumber(typeCurrency).replace("Một","")),"3"==$("#INV_TYPE").val()?($("#AmountInWords").val("Giảm "+o),n*=-1,e=-1*Math.abs(e)):BteGlobal.IS_DIEU_CHINH_TANG_GIAM?(n<0?$("#AmountInWords").val("Giảm "+o):$("#AmountInWords").val("Tăng "+o),n=t-e+a):$("#AmountInWords").val(parseFloat($("#Amount").val().FormatNumUK()).ReadNumber(typeCurrency).replace(/\s\s+/g," ")),$("#Amount").val(n.format(2,3,typeCurrency)).trigger("change"),readAfterAmountChanged_over()},this.readAfterAmountChanged_over=function(){},$("#hideDiscountOpt").change(function(){if(!CheckDiscountEmpty()&&$("#hideDiscountOpt").prop("checked"))return alert("X\xf3a số tiền \xf4 giảm trừ để ẩn"),$("#hideDiscountOpt").prop("checked",!1),!1;$("#hideDiscountOpt").prop("checked")?($("#DiscountNonTax").parents(".line").eq(0).hide(),$("#DiscountOther").parents(".line").eq(0).hide()):($("#DiscountNonTax").parents(".line").eq(0).show().removeClass("hidden"),$("#DiscountOther").parents(".line").eq(0).show().removeClass("hidden")),localStorage.setItem(BteGlobal.PATTERN_NUM+"hideDiscountOpt",$("#hideDiscountOpt").prop("checked").toString())});